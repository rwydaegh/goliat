<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Automated Python framework for near-field and far-field dosimetric assessments using Sim4Life"><meta name=author content=rwydaegh><link href=https://docs.goliat.waves-ugent.be/tutorials/04_gridding_and_phantom_rotation/ rel=canonical><link href=../03_near_field_basics/ rel=prev><link href=../05_parallel_and_cloud_execution/ rel=next><link rel=icon href=../../img/favicon.svg><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.3"><title>4. Gridding and Phantom Rotation - GOLIAT Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.50c56a3b.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><link rel=stylesheet href=../../assets/stylesheets/panzoom.css><link rel=stylesheet href=../../css/ansi-colours.css><link rel=stylesheet href=../../css/jupyter-cells.css><link rel=stylesheet href=../../css/pandas-dataframe.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta name=google-site-verification content=C67JlSIlvLnht9ILTQG5rkT49B9SoIKsXok7TbuVda4><meta name="panzoom-theme" content="material">
<meta name="panzoom-data" content='{"selectors": [".d2", ".mermaid"], "initial_zoom_level": 1.0}'> </head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tutorial-4-gridding-and-phantom-rotation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="GOLIAT Documentation" class="md-header__button md-logo" aria-label="GOLIAT Documentation" data-md-component=logo> <img src=../../img/goliat.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> GOLIAT Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 4. Gridding and Phantom Rotation </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/rwydaegh/goliat title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> rwydaegh/goliat </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../installation/ class=md-tabs__link> Installation </a> </li> <li class=md-tabs__item> <a href=../../user_guide/quick_start/ class=md-tabs__link> User Guide </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../overview/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../developer_guide/developer_guide/ class=md-tabs__link> Developer Guide </a> </li> <li class=md-tabs__item> <a href=../../cloud/overview/ class=md-tabs__link> Cloud </a> </li> <li class=md-tabs__item> <a href=../../troubleshooting/ class=md-tabs__link> Troubleshooting </a> </li> <li class=md-tabs__item> <a href=../../reference/full_features_list/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../project_info/ class=md-tabs__link> Project Info </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="GOLIAT Documentation" class="md-nav__button md-logo" aria-label="GOLIAT Documentation" data-md-component=logo> <img src=../../img/goliat.svg alt=logo> </a> GOLIAT Documentation </label> <div class=md-nav__source> <a href=https://github.com/rwydaegh/goliat title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> rwydaegh/goliat </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user_guide/quick_start/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../user_guide/user_guide/ class=md-nav__link> <span class=md-ellipsis> User Guide </span> </a> </li> <li class=md-nav__item> <a href=../../user_guide/ai_assistant/ class=md-nav__link> <span class=md-ellipsis> AI Assistant </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../01_far_field_basics/ class=md-nav__link> <span class=md-ellipsis> 1. Far-Field Basics </span> </a> </li> <li class=md-nav__item> <a href=../02_configuration_and_caching/ class=md-nav__link> <span class=md-ellipsis> 2. Configuration and Caching </span> </a> </li> <li class=md-nav__item> <a href=../03_near_field_basics/ class=md-nav__link> <span class=md-ellipsis> 3. Near-Field Basics </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 4. Gridding and Phantom Rotation </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 4. Gridding and Phantom Rotation </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#what-youll-learn class=md-nav__link> <span class=md-ellipsis> What you'll learn </span> </a> </li> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#bash-setup class=md-nav__link> <span class=md-ellipsis> Bash setup </span> </a> </li> <li class=md-nav__item> <a href=#computational-gridding-basics class=md-nav__link> <span class=md-ellipsis> Computational gridding basics </span> </a> </li> <li class=md-nav__item> <a href=#the-configuration-file class=md-nav__link> <span class=md-ellipsis> The configuration file </span> </a> <nav class=md-nav aria-label="The configuration file"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gridding-parameters class=md-nav__link> <span class=md-ellipsis> Gridding parameters </span> </a> </li> <li class=md-nav__item> <a href=#subgridding-for-antennas class=md-nav__link> <span class=md-ellipsis> Subgridding for antennas </span> </a> </li> <li class=md-nav__item> <a href=#comparing-with-and-without-subgridding class=md-nav__link> <span class=md-ellipsis> Comparing with and without subgridding </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#by_cheek-placement class=md-nav__link> <span class=md-ellipsis> By_cheek placement </span> </a> <nav class=md-nav aria-label="By_cheek placement"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=#tragus-landmark class=md-nav__link> <span class=md-ellipsis> Tragus landmark </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#phantom-rotation class=md-nav__link> <span class=md-ellipsis> Phantom rotation </span> </a> <nav class=md-nav aria-label="Phantom rotation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuration_1 class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=#binary-search-for-touching-angle class=md-nav__link> <span class=md-ellipsis> Binary search for touching angle </span> </a> </li> <li class=md-nav__item> <a href=#before-and-after-rotation class=md-nav__link> <span class=md-ellipsis> Before and after rotation </span> </a> </li> <li class=md-nav__item> <a href=#angle-offset class=md-nav__link> <span class=md-ellipsis> Angle offset </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#scene-alignment class=md-nav__link> <span class=md-ellipsis> Scene alignment </span> </a> <nav class=md-nav aria-label="Scene alignment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-it-works class=md-nav__link> <span class=md-ellipsis> How it works </span> </a> </li> <li class=md-nav__item> <a href=#why-this-matters class=md-nav__link> <span class=md-ellipsis> Why this matters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#running-the-simulations class=md-nav__link> <span class=md-ellipsis> Running the simulations </span> </a> </li> <li class=md-nav__item> <a href=#comparing-results class=md-nav__link> <span class=md-ellipsis> Comparing results </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../05_parallel_and_cloud_execution/ class=md-nav__link> <span class=md-ellipsis> 5. Parallel and Cloud Execution </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> Developer Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Developer Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer_guide/developer_guide/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../developer_guide/system_architecture/ class=md-nav__link> <span class=md-ellipsis> System Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../developer_guide/technical_guide/ class=md-nav__link> <span class=md-ellipsis> Technical Guide </span> </a> </li> <li class=md-nav__item> <a href=../../developer_guide/analysis/ class=md-nav__link> <span class=md-ellipsis> Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../developer_guide/advanced_features/ class=md-nav__link> <span class=md-ellipsis> Advanced Features </span> </a> </li> <li class=md-nav__item> <a href=../../developer_guide/configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../developer_guide/coloring_rules/ class=md-nav__link> <span class=md-ellipsis> Coloring Rules </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex> <span class=md-ellipsis> Cloud </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Cloud </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cloud/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../cloud/osparc/ class=md-nav__link> <span class=md-ellipsis> oSPARC </span> </a> </li> <li class=md-nav__item> <a href=../../cloud/monitoring/ class=md-nav__link> <span class=md-ellipsis> Monitoring dashboard </span> </a> </li> <li class=md-nav__item> <a href=../../cloud/super_studies/ class=md-nav__link> <span class=md-ellipsis> Super Studies </span> </a> </li> <li class=md-nav__item> <a href=../../cloud/cloud_setup/ class=md-nav__link> <span class=md-ellipsis> Cloud setup </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/full_features_list/ class=md-nav__link> <span class=md-ellipsis> Full List of Features </span> </a> </li> <li class=md-nav__item> <a href=../../reference/api_reference/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> <li class=md-nav__item> <a href=../../reference/useful_s4l_snippets/ class=md-nav__link> <span class=md-ellipsis> Sim4Life API snippets </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../project_info/ class=md-nav__link> <span class=md-ellipsis> Project Info </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/rwydaegh/goliat/edit/master/docs/tutorials/04_gridding_and_phantom_rotation.ipynb title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <a href=https://github.com/rwydaegh/goliat/raw/master/docs/tutorials/04_gridding_and_phantom_rotation.ipynb title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg> </a> <script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js></script> <script>
(function() {
  function addWidgetsRenderer() {
    var requireJsScript = document.createElement('script');
    requireJsScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js';

    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var jupyterWidgetsScript = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    jupyterWidgetsScript.src = widgetRendererSrc;

    document.body.appendChild(requireJsScript);
    document.body.appendChild(jupyterWidgetsScript);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script> <div class="cell border-box-sizing text_cell rendered"> <div class=inner_cell> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id=tutorial-4-gridding-and-phantom-rotation>Tutorial 4: Gridding and phantom rotation<a class=headerlink href=#tutorial-4-gridding-and-phantom-rotation title="Permanent link">&para;</a></h1> <p>Learn computational mesh strategies and advanced near-field placement techniques.</p> <h2 id=what-youll-learn>What you'll learn<a class=headerlink href=#what-youll-learn title="Permanent link">&para;</a></h2> <ul> <li>Automatic vs manual gridding</li> <li>Subgridding for antenna components</li> <li>Per-frequency grid settings</li> <li>By_cheek placement with phantom rotation</li> <li>Binary search for touching angle detection</li> <li>Scene alignment optimization</li> </ul> <p><strong>Related documentation</strong>: <a href=../../developer_guide/configuration/#gridding-parameters>Configuration (gridding parameters)</a>, <a href=../../developer_guide/advanced_features/#phantom-rotation-for-by_cheek>Advanced features (phantom rotation)</a></p> <h2 id=prerequisites>Prerequisites<a class=headerlink href=#prerequisites title="Permanent link">&para;</a></h2> <ul> <li>Tutorial 3 completed (near-field basics)</li> <li>Understanding of <abbr title="Finite-Difference Time-Domain">FDTD</abbr> grid concepts</li> <li>Antenna models available</li> </ul> <h2 id=bash-setup>Bash setup<a class=headerlink href=#bash-setup title="Permanent link">&para;</a></h2> <p>Run this once per notebook session:</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>from</span><span class=w> </span><span class=nn>pathlib</span><span class=w> </span><span class=kn>import</span> <span class=n>Path</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kn>import</span><span class=w> </span><span class=nn>importlib.util</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=n>p</span> <span class=o>=</span> <span class=n>Path</span><span class=o>.</span><span class=n>cwd</span><span class=p>()</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=k>while</span> <span class=ow>not</span> <span class=p>(</span><span class=n>p</span> <span class=o>/</span> <span class=s2>&quot;scripts&quot;</span> <span class=o>/</span> <span class=s2>&quot;notebook_helpers.py&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>    <span class=n>p</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>parent</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=n>spec</span> <span class=o>=</span> <span class=n>importlib</span><span class=o>.</span><span class=n>util</span><span class=o>.</span><span class=n>spec_from_file_location</span><span class=p>(</span><span class=s2>&quot;_&quot;</span><span class=p>,</span> <span class=n>p</span> <span class=o>/</span> <span class=s2>&quot;scripts&quot;</span> <span class=o>/</span> <span class=s2>&quot;notebook_helpers.py&quot;</span><span class=p>)</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=n>m</span> <span class=o>=</span> <span class=n>importlib</span><span class=o>.</span><span class=n>util</span><span class=o>.</span><span class=n>module_from_spec</span><span class=p>(</span><span class=n>spec</span><span class=p>)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=n>spec</span><span class=o>.</span><span class=n>loader</span><span class=o>.</span><span class=n>exec_module</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=n>run_bash</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>get_run_bash</span><span class=p>()</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=kn>import</span><span class=w> </span><span class=nn>IPython</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=n>IPython</span><span class=o>.</span><span class=n>core</span><span class=o>.</span><span class=n>display</span><span class=o>.</span><span class=n>max_output_size</span> <span class=o>=</span> <span class=kc>None</span>
</span></code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <div class=inner_cell> <div class="text_cell_render border-box-sizing rendered_html"> <p>This helper function lets you run bash commands from Python cells using <code>run_bash('command')</code>.</p> <p><strong>If you're using bash directly</strong> (recommended), ignore the Python code blocks and just run the commands directly. Make sure to always run <code>source .bashrc</code> first.</p> <hr> <h2 id=computational-gridding-basics>Computational gridding basics<a class=headerlink href=#computational-gridding-basics title="Permanent link">&para;</a></h2> <p>The <abbr title="Finite-Difference Time-Domain">FDTD</abbr> solver discretizes space into a rectangular mesh. Cell size affects both accuracy and computation time.</p> <p><strong>Key tradeoffs</strong>:</p> <ul> <li>Smaller cells: More accurate, longer simulation time</li> <li>Larger cells: Faster simulation, potential artifacts</li> <li>Optimal size: 10-20 cells per wavelength minimum</li> </ul> <p>For a 700 <abbr title=Megahertz>MHz</abbr> signal: - Wavelength in tissue: ~40-60 mm (depends on tissue type) - Recommended cell size: 2-3 mm (GOLIAT enforces a 3 mm maximum for manual grids)</p> <p>GOLIAT supports three gridding strategies:</p> <table> <thead> <tr> <th style="text-align: left;">Strategy</th> <th style="text-align: left;">When to use</th> <th style="text-align: left;">Configuration</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">Automatic</td> <td style="text-align: left;">Quick tests, uniform materials</td> <td style="text-align: left;"><code>grid_mode: "automatic"</code></td> </tr> <tr> <td style="text-align: left;">Manual</td> <td style="text-align: left;">Production runs, precise control</td> <td style="text-align: left;"><code>grid_mode: "manual"</code> + per-frequency settings</td> </tr> <tr> <td style="text-align: left;">Subgridding</td> <td style="text-align: left;">Fine details (antenna parts)</td> <td style="text-align: left;">Defined in <code>antenna_config</code></td> </tr> </tbody> </table> <p>The GOLIAT EU Project uses manual gridding with per-frequency settings for all production simulations.</p> <hr> <h2 id=the-configuration-file>The configuration file<a class=headerlink href=#the-configuration-file title="Permanent link">&para;</a></h2> <p>This tutorial uses the Thelonious phantom with two frequencies (700 <abbr title=Megahertz>MHz</abbr> and 835 <abbr title=Megahertz>MHz</abbr>) to demonstrate gridding configurations. The 700 <abbr title=Megahertz>MHz</abbr> antenna uses subgridding, while 835 <abbr title=Megahertz>MHz</abbr> does not.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>run_bash</span><span class=p>(</span><span class=s2>&quot;cat configs/tutorial_4_advanced.json&quot;</span><span class=p>)</span>
</span></code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <div class=inner_cell> <div class="text_cell_render border-box-sizing rendered_html"> <h3 id=gridding-parameters>Gridding parameters<a class=headerlink href=#gridding-parameters title="Permanent link">&para;</a></h3> <p>The <code>gridding_parameters</code> section defines global mesh settings.</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nt>&quot;gridding_parameters&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>  </span><span class=nt>&quot;global_gridding&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>    </span><span class=nt>&quot;grid_mode&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;manual&quot;</span><span class=p>,</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>    </span><span class=nt>&quot;manual_fallback_max_step_mm&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>5.0</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>  </span><span class=p>},</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>  </span><span class=nt>&quot;global_gridding_per_frequency&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>    </span><span class=nt>&quot;700&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>2.5</span><span class=p>,</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>    </span><span class=nt>&quot;835&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>2.5</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w>  </span><span class=p>},</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w>  </span><span class=nt>&quot;padding&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=w>    </span><span class=nt>&quot;padding_mode&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;manual&quot;</span><span class=p>,</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=w>    </span><span class=nt>&quot;manual_bottom_padding_mm&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>],</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=w>    </span><span class=nt>&quot;manual_top_padding_mm&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=p>}</span>
</span></code></pre></div> <p><strong>Key parameters</strong>:</p> <ul> <li><code>grid_mode</code>: Use <code>"manual"</code> for explicit control, <code>"automatic"</code> for Sim4Life defaults</li> <li><code>manual_fallback_max_step_mm</code>: Maximum cell size if no per-frequency value is defined</li> <li><code>global_gridding_per_frequency</code>: Cell size in mm for each frequency</li> <li><code>padding</code>: Extra space around simulation boundaries</li> </ul> <p>The per-frequency settings let you use finer grids for higher frequencies where wavelengths are shorter.</p> <p><img alt="Grid visualization" src=../img/tutorials/tut4_s4l_grid_comparison.png></p> <p><em>Left: Coarse 5 mm grid. Right: Fine 2.5 mm grid. Finer grids resolve more details.</em></p> <h3 id=subgridding-for-antennas>Subgridding for antennas<a class=headerlink href=#subgridding-for-antennas title="Permanent link">&para;</a></h3> <p>Subgridding applies a finer mesh to specific components without affecting the global grid. This is useful for small antenna features that need high resolution.</p> <p>Here's the 700 <abbr title=Megahertz>MHz</abbr> antenna config with subgridding:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nt>&quot;700&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>  </span><span class=nt>&quot;center_frequency&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>700</span><span class=p>,</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>  </span><span class=nt>&quot;target_power_mW&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>267</span><span class=p>,</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>  </span><span class=nt>&quot;model_type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;PIFA&quot;</span><span class=p>,</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>  </span><span class=nt>&quot;source_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Lines 1&quot;</span><span class=p>,</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>  </span><span class=nt>&quot;materials&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=err>...</span><span class=p>},</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>  </span><span class=nt>&quot;gridding&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>    </span><span class=nt>&quot;automatic&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;component1:Substrate&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;Lines 1&quot;</span><span class=p>],</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>    </span><span class=nt>&quot;subgridding&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w>      </span><span class=nt>&quot;components&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;component1:Battery&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;component1:Patch&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;Extrude 1&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;component1:ShortingPin&quot;</span><span class=p>],</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w>      </span><span class=nt>&quot;SubGridMode&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Box&quot;</span><span class=p>,</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w>      </span><span class=nt>&quot;SubGridLevel&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;x9&quot;</span><span class=p>,</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=w>      </span><span class=nt>&quot;AutoRefinement&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;AutoRefinementVeryFine&quot;</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=p>}</span>
</span></code></pre></div> <p><strong>Subgridding parameters</strong>:</p> <ul> <li><code>components</code>: List of <abbr title="Computer-Aided Design">CAD</abbr> entities to apply subgrid to</li> <li><code>SubGridMode</code>: Subgrid shape (<code>"Box"</code> is standard)</li> <li><code>SubGridLevel</code>: Resolution multiplier relative to global grid</li> <li><code>"x3"</code>: 3x finer (cell size divided by 3)</li> <li><code>"x9"</code>: 9x finer (cell size divided by 9)</li> <li>Higher values give better accuracy but increase computation time</li> <li><code>AutoRefinement</code>: Additional refinement level</li> <li><code>"AutoRefinementVeryFine"</code>: Highest quality</li> <li><code>"AutoRefinementFine"</code>: Moderate quality</li> <li><code>"AutoRefinementDefault"</code>: Standard quality</li> </ul> <p>For 700 <abbr title=Megahertz>MHz</abbr> with global grid 2.5 mm and SubGridLevel x9: - Global cell size: 2.5 mm - Subgrid cell size: 2.5 / 9 â‰ˆ 0.28 mm</p> <p>This resolves fine antenna features without making the entire domain expensive.</p> <p><img alt="Subgrid visualization" src=../img/tutorials/tut4_s4l_subgrid_antenna.png></p> <p><em>Subgrid region around antenna components (shown in red). Global grid is coarser (blue).</em></p> <h3 id=comparing-with-and-without-subgridding>Comparing with and without subgridding<a class=headerlink href=#comparing-with-and-without-subgridding title="Permanent link">&para;</a></h3> <p>The 835 <abbr title=Megahertz>MHz</abbr> antenna does not use subgridding:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nt>&quot;835&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>  </span><span class=nt>&quot;center_frequency&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>835</span><span class=p>,</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>  </span><span class=nt>&quot;target_power_mW&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>228</span><span class=p>,</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>  </span><span class=nt>&quot;model_type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;PIFA&quot;</span><span class=p>,</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>  </span><span class=nt>&quot;source_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Lines 1&quot;</span><span class=p>,</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>  </span><span class=nt>&quot;materials&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=err>...</span><span class=p>},</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>  </span><span class=nt>&quot;gridding&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>    </span><span class=nt>&quot;automatic&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;component1:Substrate&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;Lines 1&quot;</span><span class=p>]</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=p>}</span>
</span></code></pre></div> <p>This antenna uses only the global 2.5 mm grid. You can compare results to see if subgridding makes a difference for your specific antenna geometry.</p> <hr> <h2 id=by_cheek-placement>By_cheek placement<a class=headerlink href=#by_cheek-placement title="Permanent link">&para;</a></h2> <p>The <code>by_cheek</code> placement positions the phone at the ear, using the tragus (ear cartilage protrusion) as an anatomical landmark.</p> <h3 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h3> <div class="language-json highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nt>&quot;placement_scenarios&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>  </span><span class=nt>&quot;by_cheek&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>    </span><span class=nt>&quot;bounding_box&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;default&quot;</span><span class=p>,</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>    </span><span class=nt>&quot;positions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>      </span><span class=nt>&quot;tragus&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>    </span><span class=p>},</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>    </span><span class=nt>&quot;orientations&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>      </span><span class=nt>&quot;cheek_base&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>        </span><span class=nt>&quot;rotate_phantom_to_cheek&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>        </span><span class=nt>&quot;angle_offset_deg&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>      </span><span class=p>},</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=w>      </span><span class=nt>&quot;tilt_base&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[]</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=w>    </span><span class=p>},</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=w>    </span><span class=nt>&quot;antenna_reference&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=w>      </span><span class=nt>&quot;distance_from_top&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>10</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=w>    </span><span class=p>},</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=w>    </span><span class=nt>&quot;phantom_reference&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tragus&quot;</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=p>}</span>
</span></code></pre></div> <p><strong>Key differences from front_of_eyes</strong>:</p> <ul> <li>Uses <code>tragus</code> instead of <code>nasion</code> as reference point</li> <li>Distance from cheek is 8 mm (vs 200 mm from eyes)</li> <li>Includes base alignment calculation (ear-to-mouth vector)</li> <li>Supports phantom rotation option</li> </ul> <h3 id=tragus-landmark>Tragus landmark<a class=headerlink href=#tragus-landmark title="Permanent link">&para;</a></h3> <p>The <code>phantom_reference: "tragus"</code> parameter points to coordinates defined in <code>phantom_definitions</code>:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nt>&quot;phantom_definitions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>  </span><span class=nt>&quot;thelonious&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>    </span><span class=nt>&quot;tragus&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>7</span><span class=p>,</span><span class=w> </span><span class=mi>-5</span><span class=p>],</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>    </span><span class=nt>&quot;lips&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>122</span><span class=p>,</span><span class=w> </span><span class=mi>31</span><span class=p>],</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>    </span><span class=err>...</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>    </span><span class=nt>&quot;placements&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>      </span><span class=nt>&quot;do_by_cheek&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>      </span><span class=nt>&quot;distance_from_cheek&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>8</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=p>}</span>
</span></code></pre></div> <p>GOLIAT finds the ear skin entity, calculates its center, applies the tragus offset, then positions the phone 8 mm away.</p> <p><img alt="Tragus landmark" src=../img/tutorials/tut4_s4l_tragus_landmark.png></p> <p><em>Tragus anatomical landmark used as reference for by_cheek placement.</em></p> <hr> <h2 id=phantom-rotation>Phantom rotation<a class=headerlink href=#phantom-rotation title="Permanent link">&para;</a></h2> <p>For some by_cheek orientations, the phantom needs to rotate toward the phone to create realistic contact. This is configured using a dictionary format in the orientations section.</p> <h3 id=configuration_1>Configuration<a class=headerlink href=#configuration_1 title="Permanent link">&para;</a></h3> <div class="language-json highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=nt>&quot;orientations&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>  </span><span class=nt>&quot;cheek_base&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>    </span><span class=nt>&quot;rotate_phantom_to_cheek&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>    </span><span class=nt>&quot;angle_offset_deg&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=p>}</span>
</span></code></pre></div> <p><strong>Parameters</strong>:</p> <ul> <li><code>rotate_phantom_to_cheek</code>: Enable automatic rotation (boolean)</li> <li><code>angle_offset_deg</code>: Additional angle to rotate phantom away from phone after contact (number)</li> </ul> <p>When this is enabled, GOLIAT: 1. Places phone and phantom in initial positions 2. Runs binary search to find touching angle 3. Applies the angle + offset 4. Rotates phantom, bounding boxes, and sensors 5. Continues with scene alignment</p> <h3 id=binary-search-for-touching-angle>Binary search for touching angle<a class=headerlink href=#binary-search-for-touching-angle title="Permanent link">&para;</a></h3> <p>GOLIAT uses binary search to find the exact angle where the phantom's skin touches the phone's ground plane.</p> <p>The search: - Searches between 0 and 30 degrees rotation around Z axis - Uses 0.5 degree precision - Checks for overlap at each iteration - Stops when touching distance is minimized</p> <p>Watch the console output during setup to see the search progress:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>  - Handling phantom rotation...
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>  - Finding touching angle via binary search...
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>    - Testing angle: 15.00 deg (distance: 2.35 mm)
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    - Testing angle: 7.50 deg (distance: 5.82 mm)
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    - Testing angle: 11.25 deg (distance: 3.47 mm)
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    - Testing angle: 13.12 deg (distance: 2.89 mm)
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    ...
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    - Determined touching angle: 13.50 deg
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    - Applying offset: 0.00 deg
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    - Final rotation: 13.50 deg
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    - Done in 4.8s
</span></code></pre></div> <p><img alt="Binary search log" src=../img/tutorials/tut4_binary_search_log.png></p> <p><em>Console output showing binary search iterations converging to optimal angle.</em></p> <h3 id=before-and-after-rotation>Before and after rotation<a class=headerlink href=#before-and-after-rotation title="Permanent link">&para;</a></h3> <p><img alt="Before rotation" src=../img/tutorials/tut4_before_rotation.png></p> <p><em>Before rotation: Gap between phantom and phone.</em></p> <p><img alt="After rotation" src=../img/tutorials/tut4_after_rotation.png></p> <p><em>After rotation: Phantom skin touches phone ground plane.</em></p> <h3 id=angle-offset>Angle offset<a class=headerlink href=#angle-offset title="Permanent link">&para;</a></h3> <p>The <code>angle_offset_deg</code> parameter lets you fine-tune the final position. Positive values rotate the phantom away from the phone (increasing gap), negative values rotate toward it (increasing overlap).</p> <p>Examples: - <code>angle_offset_deg: 0</code>: Phantom just touches phone (default) - <code>angle_offset_deg: 2</code>: 2 degree separation (small gap) - <code>angle_offset_deg: -1</code>: 1 degree overlap (slight compression)</p> <hr> <h2 id=scene-alignment>Scene alignment<a class=headerlink href=#scene-alignment title="Permanent link">&para;</a></h2> <p>For by_cheek placements, GOLIAT automatically aligns the entire scene with the phone's upright orientation. This optimizes the computational grid and can reduce simulation time.</p> <h3 id=how-it-works>How it works<a class=headerlink href=#how-it-works title="Permanent link">&para;</a></h3> <p>After phantom rotation (if enabled), GOLIAT:</p> <ol> <li>Identifies reference entities on phone:</li> <li><abbr title="Planar Inverted-F Antenna">PIFA</abbr>: <code>component1:Substrate</code> and <code>component1:Battery</code></li> <li><abbr title="Inverted-F Antenna">IFA</abbr>: <code>Ground</code> and <code>Battery</code></li> <li>Calculates transformation matrix to make phone upright</li> <li>Applies transformation to all scene entities:</li> <li>Phantom group</li> <li>Antenna group</li> <li>Simulation bounding box</li> <li>Antenna bounding box</li> <li>Head and trunk bounding boxes</li> <li>Point sensors</li> </ol> <p>Only parent groups and bounding boxes are transformed, not individual tissues. This keeps relative geometry correct while aligning the grid with the phone.</p> <p><img alt="Scene alignment" src=../img/tutorials/tut4_s4l_scene_aligned.png></p> <p><em>Scene after alignment: Phone is upright, grid aligns with phone orientation.</em></p> <h3 id=why-this-matters>Why this matters<a class=headerlink href=#why-this-matters title="Permanent link">&para;</a></h3> <p><abbr title="Finite-Difference Time-Domain">FDTD</abbr> grids are always axis-aligned rectangular meshes. When the phone is tilted relative to the axes, the grid must use smaller cells to resolve edges accurately. Aligning the phone with the axes lets the grid use larger cells while maintaining accuracy.</p> <p>This can reduce: - Number of grid cells (by 10-30%) - Memory usage - Simulation time</p> <p>The alignment happens automatically for all by_cheek placements. No configuration is needed.</p> <hr> <h2 id=running-the-simulations>Running the simulations<a class=headerlink href=#running-the-simulations title="Permanent link">&para;</a></h2> <p>Run the study:</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class=input> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>run_bash</span><span class=p>(</span><span class=s2>&quot;goliat study tutorial_4_advanced&quot;</span><span class=p>)</span>
</span></code></pre></div> </div> </div> <div class="cell border-box-sizing text_cell rendered"> <div class=inner_cell> <div class="text_cell_render border-box-sizing rendered_html"> <p>This runs 4 simulations: 1. 700 <abbr title=Megahertz>MHz</abbr>, by_cheek, tragus position, cheek_base orientation (with rotation, with subgrid) 2. 700 <abbr title=Megahertz>MHz</abbr>, by_cheek, tragus position, tilt_base orientation (no rotation, with subgrid) 3. 835 <abbr title=Megahertz>MHz</abbr>, by_cheek, tragus position, cheek_base orientation (with rotation, no subgrid) 4. 835 <abbr title=Megahertz>MHz</abbr>, by_cheek, tragus position, tilt_base orientation (no rotation, no subgrid)</p> <p>Watch for these key steps in the logs:</p> <p><strong>For cheek_base orientation</strong>: <div class="language-text highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>  - Calculating placement details...
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>  - Calculated base rotation for cheek alignment: 84.23 degrees around X-axis.
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>  - Handling phantom rotation...
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>  - Finding touching angle via binary search...
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>  - Determined touching angle: 13.50 deg
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>  - Aligning simulation scene with phone...
</span></code></pre></div></p> <p><strong>For tilt_base orientation</strong>: <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>  - Calculating placement details...
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>  - Calculated base rotation for cheek alignment: 84.23 degrees around X-axis.
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>  - Handling phantom rotation...
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>  - Phantom rotation not enabled for this orientation.
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>  - Aligning simulation scene with phone...
</span></code></pre></div></p> <p>The setup phase takes longer for cheek_base due to the binary search (extra 5-8 seconds).</p> <hr> <h2 id=comparing-results>Comparing results<a class=headerlink href=#comparing-results title="Permanent link">&para;</a></h2> <p>After simulations complete, compare the four cases:</p> <p><strong>Subgridding comparison</strong>: - 700 <abbr title=Megahertz>MHz</abbr> (with subgrid) vs 835 <abbr title=Megahertz>MHz</abbr> (no subgrid) - Check if <abbr title="Specific Absorption Rate">SAR</abbr> hotspot patterns differ - Compare peak 10g <abbr title="Specific Absorption Rate">SAR</abbr> values</p> <p><strong>Rotation comparison</strong>: - cheek_base (with rotation) vs tilt_base (no rotation) - Check contact region <abbr title="Specific Absorption Rate">SAR</abbr> values - Compare field penetration depth</p> <h1 id=todo-analysis-and-visualization-tools-will-be-covered-in-a-future-tutorial>TODO: Analysis and visualization tools will be covered in a future tutorial.<a class=headerlink href=#todo-analysis-and-visualization-tools-will-be-covered-in-a-future-tutorial title="Permanent link">&para;</a></h1> <p>Find results in:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>results/near_field/thelonious/700MHz/
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>  by_cheek_tragus_cheek_base/     # With rotation, with subgrid
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>  by_cheek_tragus_tilt_base/      # No rotation, with subgrid
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>results/near_field/thelonious/835MHz/
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>  by_cheek_tragus_cheek_base/     # With rotation, no subgrid
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>  by_cheek_tragus_tilt_base/      # No rotation, no subgrid
</span></code></pre></div> <hr> <h2 id=gridding-recommendations>Gridding recommendations<a class=headerlink href=#gridding-recommendations title="Permanent link">&para;</a></h2> <p>Based on GOLIAT EU Project experience:</p> <p><strong>For production simulations</strong>: - Use manual gridding with per-frequency settings - 2.5 mm cells for frequencies below 1000 <abbr title=Megahertz>MHz</abbr> - 1.5-2.0 mm cells for frequencies 1000-3000 <abbr title=Megahertz>MHz</abbr> - 1.0 mm cells for frequencies above 3000 <abbr title=Megahertz>MHz</abbr></p> <p><strong>For subgridding</strong>: - Apply to small antenna components (patches, pins, batteries) - Use SubGridLevel x9 for fine metallic features - Use AutoRefinementVeryFine for best accuracy - Skip subgridding for quick test runs</p> <p><strong>For phantom rotation</strong>: - Enable for by_cheek placements where contact matters - Use <code>angle_offset_deg: 0</code> for realistic contact - Test without rotation first to verify basic setup</p> <hr> <h2 id=whats-next>What's next<a class=headerlink href=#whats-next title="Permanent link">&para;</a></h2> <p>You've learned advanced near-field techniques. Next steps:</p> <p><strong>Tutorial 5</strong>: Parallel and cloud execution - Running multiple simulations simultaneously - Config splitting strategies - Using <abbr title="Open Simulation Platform for Advanced Research and Computing">oSPARC</abbr> for cloud compute</p> <hr> <h2 id=summary>Summary<a class=headerlink href=#summary title="Permanent link">&para;</a></h2> <p>You learned: - <abbr title="Finite-Difference Time-Domain">FDTD</abbr> grids discretize space into rectangular meshes with tradeoffs between accuracy and speed - Manual gridding with per-frequency settings provides precise control - Subgridding applies finer resolution to antenna components without affecting global grid - By_cheek placement uses tragus landmark and includes automatic base alignment - Phantom rotation uses binary search to find optimal touching angle - Scene alignment optimizes grid orientation for by_cheek placements automatically - The GOLIAT EU Project uses manual 2.5 mm grids with x9 subgridding for production</p> <p>In Tutorial 5, we'll explore running multiple simulations in parallel to use multi-core systems and cloud compute resources.</p> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-content-wrapper> <div class=md-footer-nav-left> <a href=../03_near_field_basics/ class="md-footer__link md-footer__link--prev" aria-label=Previous> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> 3. Near-Field Basics </div> </div> </a> </div> <div class=md-footer-custom> <div class=footer-logos> <a href=https://waves.ugent.be target=_blank rel="noopener noreferrer" class=footer-logo-link> <img src=../../img/waves.svg alt=WAVES class="footer-logo waves-logo"> </a> <a href=https://www.ugent.be target=_blank rel="noopener noreferrer" class=footer-logo-link> <img src=../../img/ugent.png alt=UGent class="footer-logo ugent-logo"> </a> <a href=https://www.imec-int.com target=_blank rel="noopener noreferrer" class=footer-logo-link> <img src=../../img/imec.png alt=imec class="footer-logo imec-logo"> </a> </div> <div class=footer-monitoring> <a href=https://monitor.goliat.waves-ugent.be target=_blank rel="noopener noreferrer" class=monitoring-link> ðŸ“Š Check out the monitoring dashboard at monitor.goliat.waves-ugent.be </a> </div> </div> <div class=md-footer-nav-right> <a href=../05_parallel_and_cloud_execution/ class="md-footer__link md-footer__link--next" aria-label=Next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> 5. Parallel and Cloud Execution </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.d7c377c4.min.js></script> <script src=../../javascripts/ansi-to-html.js></script> <script src=../../javascripts/footer-width-match.js></script> <script src=../../javascripts/code-block-enhancements.js></script> <script src=../../assets/javascripts/panzoom.min.js></script> <script src=../../assets/javascripts/zoompan.js></script> </body> </html>